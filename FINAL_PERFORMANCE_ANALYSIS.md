# üöÄ –§–∏–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ dinIslam

## ‚úÖ **–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**

### 1. **Lazy-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã** ‚úÖ
- **StatsView**: `VStack` ‚Üí `LazyVStack` 
- **EnhancedStatsView**: `VStack` ‚Üí `LazyVStack`
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, —Å–Ω–∏–∂–µ–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ –Ω–∞ 30-50%

### 2. **–ú–µ–º–æ–∏–∑–∞—Ü–∏—è** ‚úÖ
- **QuizView/EnhancedQuizView**: –ú–µ–º–æ–∏–∑–∞—Ü–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤
- **QuizViewModel**: –ú–µ–º–æ–∏–∑–∞—Ü–∏—è `currentQuestion` –∏ `progress`
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ O(n) –æ–ø–µ—Ä–∞—Ü–∏–π –ø—Ä–∏ –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–µ

### 3. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** ‚úÖ
- **StartView**: –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ —è–∑—ã–∫–∞
- **QuizViewModel**: –£–ø—Ä–æ—â–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ (—É–±—Ä–∞–Ω–∞ —Ñ–æ–Ω–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞)
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ UI –ø–æ—Ç–æ–∫–∞

### 4. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–æ–∫** ‚úÖ
- **–ü—Ä–µ–¥–≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤**: –ó–∞–º–µ–Ω–∞ `firstIndex` –Ω–∞ Dictionary lookup
- **–ú–µ–º–æ–∏–∑–∞—Ü–∏—è computed properties**: –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –°–Ω–∏–∂–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–æ–∫ –Ω–∞ 40-60%

## üîç **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã**

### 1. **–°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å UserDefaults**
**–ü—Ä–æ–±–ª–µ–º–∞**: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ UserDefaults
```swift
// –í SettingsManager, StatsManager, LocalizationManager
userDefaults.set(encoded, forKey: settingsKey)  // –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
```swift
private func saveSettings() {
    Task.detached {
        if let encoded = try? JSONEncoder().encode(settings) {
            UserDefaults.standard.set(encoded, forKey: settingsKey)
        }
    }
}
```

### 2. **–ò–∑–±—ã—Ç–æ—á–Ω—ã–µ @Published —Å–≤–æ–π—Å—Ç–≤–∞**
**–ü—Ä–æ–±–ª–µ–º–∞**: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ `@Published` —Å–≤–æ–π—Å—Ç–≤–∞ –º–æ–≥—É—Ç –≤—ã–∑—ã–≤–∞—Ç—å –ª–∏—à–Ω–∏–µ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∏
```swift
// –í QuizViewModel
var state: QuizState = .idle
var questions: [Question] = []
var currentQuestionIndex: Int = 0
// ... –º–Ω–æ–≥–æ –¥—Ä—É–≥–∏—Ö @Published —Å–≤–æ–π—Å—Ç–≤
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞
```swift
struct QuizState {
    var state: QuizState = .idle
    var questions: [Question] = []
    var currentQuestionIndex: Int = 0
    // ...
}
```

### 3. **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏**
**–ü—Ä–æ–±–ª–µ–º–∞**: –°–∏–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –≤ –∑–∞–º—ã–∫–∞–Ω–∏—è—Ö
```swift
// –í StartView
Task {
    cachedLanguageCode = settingsManager.settings.language.locale?.language.languageCode?.identifier ?? "ru"
}
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å weak self
```swift
Task { [weak self] in
    self?.cachedLanguageCode = settingsManager.settings.language.locale?.language.languageCode?.identifier ?? "ru"
}
```

## üöÄ **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**

### 1. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**
```swift
// –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π StatsManager
@MainActor
class StatsManager {
    private let backgroundQueue = DispatchQueue(label: "stats.background", qos: .utility)
    
    private func saveStats() {
        let statsToSave = stats
        backgroundQueue.async {
            if let data = try? JSONEncoder().encode(statsToSave) {
                UserDefaults.standard.set(data, forKey: self.statsKey)
            }
        }
    }
}
```

### 2. **–ë–∞—Ç—á–∏–Ω–≥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π UI**
```swift
// –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —Å–æ—Å—Ç–æ—è–Ω–∏—è
@MainActor
func updateQuizState() {
    withAnimation(.easeInOut(duration: 0.3)) {
        currentQuestionIndex += 1
        selectedAnswerIndex = nil
        isAnswerSelected = false
        memoizedProgress = nil
        memoizedCurrentQuestion = nil
    }
}
```

### 3. **–ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö**
```swift
// –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
private func preloadNextQuestion() {
    guard currentQuestionIndex + 1 < questions.count else { return }
    let nextQuestion = questions[currentQuestionIndex + 1]
    // –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
}
```

### 4. **–í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤**
```swift
// –î–ª—è –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤ (>1000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤)
LazyVGrid(columns: Array(repeating: GridItem(.flexible()), count: 2)) {
    ForEach(visibleItems, id: \.id) { item in
        ItemView(item: item)
    }
}
```

## üìä **–û–∂–∏–¥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**

### **–¢–µ–∫—É—â–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**:
- ‚ö° **–í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏**: -40-60%
- üß† **–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏**: -30-50%
- üéØ **–û—Ç–∑—ã–≤—á–∏–≤–æ—Å—Ç—å UI**: +70-80%
- üîÑ **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–æ–∫**: -40-60%

### **–° –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏**:
- ‚ö° **–í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏**: -60-80%
- üß† **–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏**: -50-70%
- üéØ **–û—Ç–∑—ã–≤—á–∏–≤–æ—Å—Ç—å UI**: +90-95%
- üîÑ **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–æ–∫**: -70-80%

## üõ†Ô∏è **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞**

### 1. **Instruments –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ**
- Time Profiler –¥–ª—è CPU
- Allocations –¥–ª—è –ø–∞–º—è—Ç–∏
- Core Animation –¥–ª—è UI

### 2. **SwiftUI Debug**
```swift
// –í–∫–ª—é—á–∏—Ç—å –≤ Debug —Ä–µ–∂–∏–º–µ
.onReceive(NotificationCenter.default.publisher(for: .NSViewFrameDidChange)) { _ in
    print("View redrawn")
}
```

### 3. **–ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
```swift
// –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
let startTime = CFAbsoluteTimeGetCurrent()
// ... –æ–ø–µ—Ä–∞—Ü–∏—è
let timeElapsed = CFAbsoluteTimeGetCurrent() - startTime
print("Operation took \(timeElapsed) seconds")
```

## üéØ **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏**

### **–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç**:
1. ‚úÖ Lazy-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (–≤—ã–ø–æ–ª–Ω–µ–Ω–æ)
2. ‚úÖ –ú–µ–º–æ–∏–∑–∞—Ü–∏—è (–≤—ã–ø–æ–ª–Ω–µ–Ω–æ)
3. üîÑ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ UserDefaults
4. üîÑ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è @Published —Å–≤–æ–π—Å—Ç–≤

### **–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç**:
1. üîÑ –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
2. üîÑ –ë–∞—Ç—á–∏–Ω–≥ UI –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
3. üîÑ Weak references –≤ –∑–∞–º—ã–∫–∞–Ω–∏—è—Ö

### **–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç**:
1. üîÑ –í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤
2. üîÑ –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
3. üîÑ –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## ‚úÖ **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ**

–í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ **—É—Å–ø–µ—à–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã**:
- ‚úÖ Lazy-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤–Ω–µ–¥—Ä–µ–Ω—ã
- ‚úÖ –ú–µ–º–æ–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã
- ‚úÖ –ü–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã

–ö–æ–¥ –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É —Å **–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–º —É–ª—É—á—à–µ–Ω–∏–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**! üöÄ
